**Базы данных и SQL запросы**  
Дан софт, автоматизирующий работу библиотеки. 3НФ схемы БД софта выглядит следующим образом:

**Произведение**  
● id  
● название

**Издание**  
● id  
● id\_произведения  
● год издания  
● кол-во страниц

**Экземпляр**  
● id  
● id\_издание  
● инвентаризационный номер

**Лог операций**  
● id  
● id\_user  
● id\_экземпля  
● дата\_взяли  
● дата\_вернули

**Нужно написать скрипты sql, которые отвечают на следующие вопросы:**  
1\) Найти произведения, которые издавались более 5 раз.  
2\) Проверить, есть ли экземпляры, не привязанные к ни к одному изданию.  
3\) Для каждого пользователя найти последние три взятые им произведения. Для каждого такого произведения указать сколько всего раз ее брали (за все время).  
4\) Список самых неблагонадежных пользователей библиотеки – рейтинг 10 самых-самых плохих пользователей по двум или более критериям. Критерии неблагонадежности, с точки зрения бизнеса, предложите самостоятельно.

**Дополнительные комментарии:**  
1\) При оценке результата учитывается оптимальность выборок данных и возвращаемых результатов.  
2\) Если задачу можно решить без вложенного запроса, то решение с вложенным запросом не оптимально. Секция with – это тоже вложенный запрос.  
3\) Считаем, что доступны все возможности языка SQL определенных в стандартах ANSI SQLи Hive QL (https://cwiki.apache.org/confluence/display/Hive/LanguageManual).

**Оценка критериев объявления:**  
У вас есть сайт \- доска объявлений (например, циан, авито, алиэкспресс и д.р.   
Не нужно привязываться к функционалу конкретного сайта.  
Задание \- предложить набор показателей, оценивающих качество базы объявлений.

**Оценка рекламных каналов:**  
В течении двух недель маркетологи проводили эксперименты по двум разным рекламным площадкам (например, google и yandex). На обоих ресурсах реклама была показана примерно одинаковое число раз. Какие показатели нужно измерить, чтобы сравнить эти две площадки? Маркетологи хотят оставить одну площадку. Какие будут ваши рекомендации по выбору?

Комментарий: рекомендации это не просто перечень показателей, а рекомендации по их интерпретации и принятию решения на их основе.

**Автор: [https://link.sergeyfilichkin.ru/tg\_t](https://link.sergeyfilichkin.ru/tg_t)**